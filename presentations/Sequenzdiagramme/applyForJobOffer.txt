title application
actor User
participant ApplicationController
participant AppUserDetailsService
participant ApplicationService
participant AppUserRepository
participant JobOfferRepository
participant JobApplicationRepository


database Database

activate User
activate Database
User->ApplicationController:GET /offer/{JobOffer.id}/apply
activate ApplicationController
ApplicationController->AppUserDetailsService: getCurrentAuthenticatedUser()
activate AppUserDetailsService
AppUserDetailsService ->AppUserRepository:findById()
activate AppUserRepository
AppUserRepository->Database:SELECT AppUser
AppUserRepository<--Database:AppUser
AppUserDetailsService<--AppUserRepository:AppUser
deactivate AppUserRepository
ApplicationController<--AppUserDetailsService:AppUser
deactivate AppUserDetailsService
ApplicationController->ApplicationService:applyForJobOffer()
activate ApplicationService
ApplicationService->JobOfferRepository:findByID(offerID)
activate JobOfferRepository
JobOfferRepository->Database:SELECT JobOffer
JobOfferRepository<--Database:JobOffer
ApplicationService<--JobOfferRepository:JobOffer
deactivate JobOfferRepository
ApplicationService->ApplicationService:applyForJobOffer(AppUser, JobOffer)
activate ApplicationService
ApplicationService->JobApplicationRepository:save(application)
activate JobApplicationRepository
JobApplicationRepository->Database:INSERT application
deactivate JobApplicationRepository
deactivate ApplicationService
deactivate ApplicationService

User<--ApplicationController: REDIRECT /offer/{id}/
deactivate ApplicationController